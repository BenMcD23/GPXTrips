{% extends 'base_manager.html' %}

{% block title %}Revenue{% endblock %}

{% block content %}
{% if noData == True %}
    <h1>No Revenue Data</h1>

{% else %}
    <select>
        <option value="future">View Estimated Future Revenue</option>
        <option value="past">View Past Revenue</option>
    </select>

    <div class="chart-container">
        <h1>Future Revenue Estimates</h1>
        <!-- chart of future revenue estimates -->
        <canvas id="myChart"></canvas>

        <div id="revenueEstimates">
            <!-- Get actual total value from past data from DB -->
            <h2>Revenue Estimates</h2>
            <p>Current Compound Weekly Growth Rate: {{ CWGR_rev }}</p> 
            <p>This is what the future revenue is based on</p>
        </div>

        <div class="form">
            <form method="post" action="" name="searchUsers">
                {{ ChangeRevWeeksForm.hidden_tag() }}
          
                <label for="weeks">Display Revenue By Weeks</label>
          
                {% if ChangeRevWeeksForm.weeks.errors %}
                {{ ChangeRevWeeksForm.weeks(class="form-control form-control-lg is-invalid") }}
                <div class="invalid-feedback">
                    {% for error in ChangeRevWeeksForm.weeks.errors %}
                        <span>â€¢ {{ error }}</span>
                        <br>
                    {% endfor %}
                </div>
                {% else %}
                {{ ChangeRevWeeksForm.weeks(class="form-control", placeholder="Number of Weeks") }}
                {% endif %}
          
                <div class="formButton">
                    {{ ChangeRevWeeksForm.submitWeeks }}
                </div>
            </form>
        </div>

    </div>



    <!-- chart script -->
    <script nonce="{{ csp_nonce() }}">
        // estimated rev graph
        const labels = {{ labels | tojson }};

        const data = {
        labels: labels,
        datasets: [
            {
                label: 'Estimated Revenue',
                // sets colour of the line, change both for colour change
                backgroundColor: 'rgb(100, 99, 132)',
                borderColor: 'rgb(100, 99, 132)',
                data: {{ revData | tojson }},
            },
            {
                label: 'Estimated Customers',
                // sets colour of the line, change both for colour change
                backgroundColor: 'rgb(200, 99, 132)',
                borderColor: 'rgb(200, 99, 132)',
                data: {{ customerData | tojson }},
            }
        ]
        };

        const config = {
        type: 'line',
        data: data,
        options: { maintainAspectRatio: false }
        };

        const myChart = new Chart(
        document.getElementById('myChart'),
        config
        );


    </script>

{% endif %}
{% endblock %}
